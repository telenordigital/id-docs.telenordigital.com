<!doctype html>
<html class="docs-html">
<head>
  <meta charset="utf-8">
  <title>Client security measures - CONNECT ID Documentation</title>
    <meta name="description" content="Client security measures">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Client security measures - CONNECT ID Documentation">
  <meta name="twitter:description" content="Client security measures">
  <meta name="twitter:image" content="https://telenordigital.github.io/id-docs.telenordigital.com/img/og_image.jpg">

  <!-- Open Graph data -->
  <meta property="og:title" content="Client security measures - CONNECT ID Documentation" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://telenordigital.github.io/id-docs.telenordigital.com/authorization-and-authentication/client-security-measures.html" />
  <meta property="og:image" content="https://telenordigital.github.io/id-docs.telenordigital.com/img/og_image.jpg" />
  <meta property="og:description" content="Client security measures" />
  <meta property="og:site_name" content="CONNECT ID Documentation" />

  <link rel="stylesheet" type="text/css" href="/id-docs.telenordigital.com/style/style.css">
    <link rel="stylesheet" type="text/css" href="/id-docs.telenordigital.com/script/swagger-ui/swagger-ui-docs-preset.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link id="searchIndex" href="/id-docs.telenordigital.com/index.json" rel="preload" as="fetch">
</head>
<body class="docs-body">
  <div id="docs-topbar" class="docs-topbar no-print">
    <div id="docs-topbar__inner" class="docs-topbar__inner">
      <a href="#" id="docs-menu-toggle" class="docs-topbar__icon docs-topbar__icon--menu-toggle hidden-desktop"><i class="material-icons md-24">menu</i></a>
      <a href="#" id="docs-search-hide" class="docs-topbar__icon docs-topbar__icon--search-hide hidden-desktop"><i class="material-icons md-24">arrow_back</i></a>
      <div class="docs-topbar__icon docs-topbar__icon--search visible-desktop"><i class="material-icons md-24">search</i></div>
      <input id="docs-search-box" type="text" class="docs-topbar__search-box" placeholder="Search" tabindex="1" autocapitalize="none" autocomplete="off" autocorrect="off" autofocus />
      <a href="#" id="docs-search-close" class="docs-topbar__icon docs-topbar__icon--search-close"><i class="material-icons md-24">close</i></a>
      <a href="#" id="docs-search-show" class="docs-topbar__icon docs-topbar__icon-search-show hidden-desktop"><i class="material-icons md-24">search</i></a>

          <a class="docs-topbar__link visible-desktop" href="https://github.com/telenordigital/id-docs.telenordigital.com">On Github</a>
    </div>
    <div id="docs-search" class="docs-search">
      <ul id="docs-search-results" class="docs-search-results"></ul>
    </div>
  </div>
  <div id="docs-sidebar" class="docs-sidebar visible-desktop no-print">
    <nav class="docs-nav">
      <a class="docs-nav__logo" href="/id-docs.telenordigital.com/"></a>
        <ul class="docs-nav__ul">
                <li class="docs-nav__li docs-nav__li--category">
                          <span class="docs-nav__item">Get started</span>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/get-started/register-client.html" class="docs-nav__item">Register client</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/get-started/client-registration-details.html" class="docs-nav__item">Required registration details</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--category">
                          <span class="docs-nav__item">What is CONNECT?</span>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/how-it-works.html" class="docs-nav__item">How it works</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/single-sign-on.html" class="docs-nav__item">Single sign on</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/levels-of-assurance.html" class="docs-nav__item">Levels of assurance</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/account-management.html" class="docs-nav__item">Account management</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/other-features.html" class="docs-nav__item">Other CONNECT features</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/what-is-connect/ui-examples.html" class="docs-nav__item">UI examples</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/general-recommendations.html" class="docs-nav__item">General recommendations</a>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/general-recommendations/integration-sign-in-details.html" class="docs-nav__item">Integration details for handling sign in</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/general-recommendations/session-handling.html" class="docs-nav__item">Session handling</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/general-recommendations/terminology.html" class="docs-nav__item">Terminology/Glossary</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--category">
                          <span class="docs-nav__item">Integrate</span>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/integrate-android-sdk.html" class="docs-nav__item">Android SDK integration</a>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/setup.html" class="docs-nav__item">Setup</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/sign-in-user.html" class="docs-nav__item">Sign in user</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/get-access-token.html" class="docs-nav__item">Get a valid access token</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/access-user-information.html" class="docs-nav__item">Access user information</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/check-user-state.html" class="docs-nav__item">Check user state</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/customise-the-user-experience.html" class="docs-nav__item">Customise the user experience</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-android-sdk/go-to-production.html" class="docs-nav__item">Go to production</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/integrate-ios-sdk.html" class="docs-nav__item">iOS SDK integration</a>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-ios-sdk/set-up.html" class="docs-nav__item">Set up</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-ios-sdk/check-user-is-signed-in.html" class="docs-nav__item">Check user is signed in</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/integrate-ios-sdk/get-access-token.html" class="docs-nav__item">Get access token</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/integrate-web-app.html" class="docs-nav__item">Web application integration</a>
                </li>
                <li class="docs-nav__li docs-nav__li--category">
                          <span class="docs-nav__item">CONNECT features</span>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/authorization-and-authentication.html" class="docs-nav__item">Authorization &amp; authentication</a>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/authorization-and-authentication/scope.html" class="docs-nav__item">Scope</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/authorization-and-authentication/client-security-measures.html" class="docs-nav__item">Client security measures</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/authorization-and-authentication/id-token.html" class="docs-nav__item">ID token</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/authorization-and-authentication/sso.html" class="docs-nav__item">Single sign-on</a>
                            </li>
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/authorization-and-authentication/authorization-examples.html" class="docs-nav__item">Authorization code examples</a>
                            </li>
                    </ul>
                </li>
                <li class="docs-nav__li docs-nav__li--subgroup">
                          <a href="/id-docs.telenordigital.com/user-data.html" class="docs-nav__item">User data</a>
                </li>
                <li class="docs-nav__li docs-nav__li--category">
                          <span class="docs-nav__item">API Reference</span>
                    <ul class="docs-nav__ul">
                            <li class="docs-nav__li">
                                      <a href="/id-docs.telenordigital.com/apireference/authentication.html" class="docs-nav__item">Authentication &amp; authorization</a>
                            </li>
                    </ul>
                </li>
        </ul>
        <div class="docs-sidebar__menuLinks hidden-desktop">
          <hr class="docs-nav__hr" />
          <ul class="docs-nav__ul">
              <li class="docs-nav__li">
                <a href="https://github.com/telenordigital/id-docs.telenordigital.com" class="docs-nav__item">On Github</a>
              </li>
          </ul>
        </div>
    </nav>
  </div>
  <div id="barba-wrapper" class="docs-wrapper">
    <div class="docs-content barba-container">
      <h1>Client security measures</h1>
        <ol class="docs-breadcrumbs tn-breadcrumbs visible-desktop">
                <li class="tn-breadcrumb">
                    <a href="/id-docs.telenordigital.com/">Home</a>
                </li>
              <li class="tn-breadcrumb">
                      <a href="/id-docs.telenordigital.com/authorization-and-authentication.html">Authorization &amp; authentication</a>
              </li>
            <li class="tn-breadcrumb tn-breadcrumb--active">Client security measures</li>
        </ol>
      <p>In this document, we present a list of important security measures that need to be taken into
account when implementing clients that integrate towards the authentication and authorization APIs
for CONNECT ID.</p>
<h2 id="store-secrets-securely">Store secrets securely</h2>
<ul>
<li><strong>Client ID</strong> - The client ID is considered public, and there are no requirements on how to store
it.</li>
<li><strong>Client secret</strong> - <em>Confidential clients</em> (e.g. a web application or a native app with a
server-side component) will get a client secret issued by the authorization server to be used to
authenticate the client to the authorization server. The client secret must be stored in a way that
it is not available for third parties. For instance, a client that is configured to be confidential
that consists of a native app and a server-side component, must only store the client secret in the
server-side component, and not in the native app itself. <em>Public clients</em>
will not be issued a client secret by the authorization sever.
This makes it impossible to authenticate the client to the authorization server, and there will
therefore exist restrictions on the functionality available to public clients.</li>
<li><strong>Authorization code</strong> - This is a short-lived provisional token with one-time usage restriction
for fetching other tokens. The authorization code should not be stored at all, but rather exchanged
for access/refresh/<a href="id-token.html">ID token</a> as soon as the client gets hold of it.</li>
<li><strong>Access/refresh/ID token</strong> - The access token must be stored securely, e.g. in the device’s
secure storage for pure native apps (public clients).
However, since it is short-lived, it may be kept only in memory.
Refresh and ID tokens and potential service-specific session IDs must be stored securely,
e.g. in the device’s secure storage for pure native apps (public clients).
For confidential clients, access, refresh, and ID tokens should only be stored server-side and
out of reach for third parties.
For example, none of these tokens should be stored in cookies.</li>
</ul>
<h2 id="encrypt-all-communication-to-and-from-clients">Encrypt all communication to and from clients</h2>
<p>Encryption could be done e.g. using TLS/SSL (HTTPS). CONNECT only allows use of TLS/SSL (HTTPS) for
requests towards its authorization server and resource servers. Service providers need to make sure
that all other communication to and from the clients, e.g. with service-specific resource servers,
is encrypted appropriately.</p>
<h2 id="protect-client-callback-endpoint-against-csrf-attacks">Protect client callback endpoint against CSRF attacks</h2>
<p>Clients must protect the redirect URI client callback endpoint against cross-site request forgery
(CSRF) attacks, according to
<a href="https://tools.ietf.org/html/rfc6749#section-10.12">section 10.12 in the OAuth specification (RFC 6749)</a>.
The recommended way to avoid CSRF attacks is to supply a cryptographically random value
in the state parameter for the authorization request and verify it for the response in
the client callback endpoint, ref <a href="authorization-examples.html">client sample code</a>. Please see
<a href="https://tools.ietf.org/html/rfc6749#section-10.12">section 10.12</a> in the OAuth specification
(RFC 6749) and <a href="https://tools.ietf.org/html/rfc6819#section-4.4.1.8">section 4.4.1.8</a> in the
OAuth 2.0 Threat Model and Security Considerations specification (RFC 6819) for details.
Note that no confidential data should be passed in the state parameter.</p>
<h2 id="validate-access-token-for-all-access-to-protected-resources">Validate access token for all access to protected resources</h2>
<p>Clients must validate the access token for all access to protected resources,
including its own service-specific protected resources.
As mentioned in the <a href="../authorization-and-authentication.html#access-token-validation">access token validation</a>
documentation, this should be done according to
<a href="https://tools.ietf.org/html/rfc6749#section-7">section 7 in the OAuth specification (RFC 6749)</a>
and the <a href="https://tools.ietf.org/html/rfc6750">OAuth bearer token usage specification (RFC 6750)</a>.</p>
<h2 id="validate-id-token-if-the-openid-scope-value-is-used">Validate ID token if the openid scope value is used</h2>
<p>If the client is requesting an <a href="id-token.html">ID token</a> by asking for the openid scope value,
the returned ID token must be validated. As mentioned in the
<a href="id-token.html#id-token-validation">ID token validation</a>
documentation, this should be done according to the
<a href="http://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">OpenID Connect Core spec, section 3.1.3.7</a>.</p>
<h2 id="recommendation-use-an-external-browser-for-authorization-request-for-native-apps">Recommendation: Use an external browser for authorization request for native apps</h2>
<p>Native apps typically have a number of different choices for what kind of browser to use for
redirects to the
<a href="http://docs.telenordigital.com/apis/connect/id/authentication.html#authorization-server-user-authorization">/authorize</a>
endpoint.
Typical choices are:</p>
<ol>
<li>An external browser (the system browser).</li>
<li>A secure embedded browser that provides sandboxed integration with an external browser.
Examples:
<a href="https://developer.apple.com/library/ios/documentation/SafariServices/Reference/SFSafariViewController_Ref/">Safari View Controller</a>
on iOS and <a href="https://developer.chrome.com/multidevice/android/customtabs">Chrome Custom Tabs</a>
on Android.</li>
<li>A less secure embedded browser. Example: WebView.</li>
</ol>
<p>For native apps on platforms that we do not provide an SDK for, we recommend using an
external browser (i.e. not an embedded browser).
One main reason is that using an embedded browser defeats the purpose of OAuth, which is that
the end user should only supply their credentials directly to the authorization server,
and not to or via the client.</p>
<p>Despite the important security advantages of using an external browser, it is relatively common
to use embedded browsers for third party login in apps.
Apple does even require that a user should be able to log in without opening an external browser,
in order for an app to be accepted for the App Store.
Therefore, an embedded browser has to be used for iOS apps and may be used for apps on other
platforms as well.
If the SDK is not used for an iOS app, we recommend using Safari View Controller, available on
iOS 9 and onward.
If neither the SDK nor an external browser is used for an Android app, we recommend using
Chrome Custom Tabs, available with Chrome 45 on Android 4.1 and onward.</p>
<p>We discourage using WebViews for the following reasons:</p>
<ul>
<li><strong>Security</strong> - The app has complete control of the WebView layer, opening up for the possibility
that the end user’s credentials are captured by the app (phishing attacks).
When using an external or secure embedded browser, this is much harder to do, since the browser is
run in a process separate from the app which prevents it from getting access to user input.</li>
<li><strong>Trust</strong> - The amount of control the app has over the WebView layer will
typically result in a range of different client-specific adaptations, e.g. removing
the address bar and doing significant changes to layout and styling.
When using an external or secure embedded browser, this is not possible and users will
get consistent user experience, which is good for two reasons.
Firstly, well-known visual protections like the SSL lock and address bar will always be there,
which will contribute to end users trusting that they supply their credentials securely to the
right place.
Secondly, consistent user experience for all apps using CONNECT ID for login will train users
what to expect and will make it easier for them to detect potential phishing attacks.</li>
<li><strong>User convenience</strong> - For WebViews, cookies are sandboxed per application, which means
that cookies are not shared between applications.
The consequence is that the single sign-on (SSO) functionality, which is very convenient
for end users, will not work if WebViews are used.
If an external browser or a secure browser that integrates with an external browser is used instead,
features like password autofill will be available in addition to SSO.
In addition to increased user convenience, this will probably increase end user trust, as well as
conversion rates.</li>
<li><strong>Developer convenience</strong> - For the app developer, the clear separation between an external
or secure embedded browser and the app makes the integration with the browser simpler and less
prone to errors and unnecessary custom adaptations than when using a WebView.</li>
</ul>

      <div class="lesson-nav">
          <a class="prev" href="/id-docs.telenordigital.com/authorization-and-authentication/authorization-examples.html">&larr; Authorization code examples</a>
          <a class="next right" href="/id-docs.telenordigital.com/authorization-and-authentication/id-token.html">ID token &rarr;</a>
      </div>
        <a class="docs-edit-btn no-print" href="https://github.com/TelenorDigital/id-docs.telenordigital.com/edit/master/docs/authorization-and-authentication/client-security-measures.md" target="_blank">Edit this page</a>
    </div>
  </div>
    <script src="/id-docs.telenordigital.com/script/swagger-ui/swagger-ui-bundle.js" ></script>
    <script src="/id-docs.telenordigital.com/script/swagger-ui/swagger-ui-docs-preset.js" ></script>
  <script src="/id-docs.telenordigital.com/script/vendor.js" ></script>
  <script src="/id-docs.telenordigital.com/script/script.js" ></script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
</body>
</html>
